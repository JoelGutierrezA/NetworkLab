<!-- Header -->
<app-header-dashboard></app-header-dashboard>

<div class="community-page">
        <main class="community-main container">
            <div class="community-grid">
                <!-- Main column: composer arriba, feed debajo -->
                <div class="main-column">
                    <section class="composer composer-top">
                        <div class="composer-row">
                            <div class="composer-avatar">{{ user.avatar || 'üë§' }}</div>
                            <div class="composer-body">
                                <form (ngSubmit)="createPost()" #postForm="ngForm">
                                    <input type="text" class="form-control" placeholder="T√≠tulo" [(ngModel)]="newPost.title" name="title" required />
                                    <textarea class="form-control" rows="4" placeholder="Comparte una actualizaci√≥n, pregunta o recurso" [(ngModel)]="newPost.content" name="content" required></textarea>
                                    <div class="composer-actions spaced">
                                        <input type="text" class="form-control small" placeholder="Etiquetas (separadas por comas)" [(ngModel)]="newPost.tags" name="tags" />
                                        <div class="actions-right">
                                            <button type="button" class="btn-secondary" (click)="newPost = { title:'', content:'', tags:'' }">Cancelar</button>
                                            <button class="btn-primary" type="submit" [disabled]="postForm.invalid">Publicar</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </section>

                    <section class="feed">
                        <h2>Comunidad</h2>
                        <div *ngIf="posts.length === 0" class="empty-feed">A√∫n no hay publicaciones. S√© el primero en compartir algo.</div>
                        <div class="post-card" *ngFor="let post of posts">
                            <div class="post-header">
                                <div class="avatar">{{ post.author?.avatar || 'üë§' }}</div>
                                <div class="post-meta">
                                    <strong>{{ post.author?.name || 'Usuario' }}</strong>
                                    <span class="post-time">{{ post.createdAt | date:'short' }}</span>
                                </div>
                            </div>
                            <div class="post-body">
                                <h3>{{ post.title }}</h3>
                                <p>{{ post.content }}</p>
                                <div class="post-tags">
                                    <span class="tag" *ngFor="let t of post.tagsArray">{{ t }}</span>
                                </div>
                            </div>
                            <div class="post-actions">
                                <button class="btn-link" (click)="likePost(post)">üëç {{ post.likes || 0 }}</button>
                                <button class="btn-link" (click)="focusComment(post)">üí¨ Comentar</button>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Sidebar: tendencias / usuarios -->
                <aside class="sidebar">
                    <div class="widget">
                        <h4>Tendencias</h4>
                        <ul>
                            <li *ngFor="let tag of trendingTags">{{ tag }}</li>
                        </ul>
                    </div>

                    <div class="widget">
                        <h4>Usuarios populares</h4>
                        <ul>
                            <li *ngFor="let u of popularUsers">
                                {{ u.name }}
                                <button class="btn-link" title="Ver usuario" (click)="openUser(u.id || null)">üîç</button>
                            </li>
                        </ul>
                    </div>
                </aside>
            </div>
        </main>

    <app-footer></app-footer>
</div>
<!-- User modal -->
<div class="modal-backdrop" *ngIf="selectedUser">
    <div class="modal-card">
        <button class="modal-close" (click)="closeUserModal()">‚úï</button>
        <h3>{{ selectedUser.first_name }} {{ selectedUser.last_name }}</h3>
        <p><strong>Email:</strong> {{ selectedUser.email }}</p>
        <p><strong>Rol:</strong> {{ selectedUser.role }}</p>
        <p><strong>Instituci√≥n:</strong> {{ selectedUser.institution_name }}</p>
        <p><strong>Biograf√≠a:</strong></p>
        <p>{{ selectedUser.bio }}</p>
    </div>
</div>
                      <div class="activity-icon">üî¨</div>

                      <div class="activity-content">

                          <h4>Nuevo Servicio Agregado</h4>
