<!-- HEADER -->
<app-header-dashboard></app-header-dashboard>

<div class="detail-wrapper" *ngIf="user">
  <div class="detail-header">
    <h2>Detalle de Usuario</h2>
    <div class="action-top-right">
      <!-- Cuando NO estamos editando: Volver + Editar -->
      <button type="button" class="btn-secondary" *ngIf="!isEditing" (click)="goBack()" aria-label="Volver a perfil">Volver</button>
      <button type="button" class="btn-primary" *ngIf="!isEditing" (click)="toggleEdit()" aria-label="Editar usuario">Editar</button>

  <!-- Cuando estamos editando: Guardar + Cancelar -->
  <button type="submit" form="userForm" class="btn-primary" *ngIf="isEditing" aria-label="Guardar cambios">Guardar</button>
  <button type="button" class="btn-secondary" *ngIf="isEditing" (click)="cancelEdit()" aria-label="Cancelar edición">Cancelar</button>
    </div>
  </div>

  <!-- FORMULARIO EN DOS COLUMNAS -->
  <form id="userForm" (ngSubmit)="saveChanges()">
    <div class="grid-2">
      <div class="form-field">
        <label for="user-first_name">Nombre</label>
        <input id="user-first_name" type="text" class="form-control" [(ngModel)]="user.first_name" name="first_name" [disabled]="!isEditing" />
      </div>

      <div class="form-field">
        <label for="user-last_name">Apellido</label>
        <input id="user-last_name" type="text" class="form-control" [(ngModel)]="user.last_name" name="last_name" [disabled]="!isEditing" />
      </div>

      <div class="form-field">
        <label for="user-email">Email</label>
        <input id="user-email" type="email" class="form-control" [(ngModel)]="user.email" name="email" [disabled]="!isEditing" />
      </div>

      <div class="form-field">
        <label for="user-role">Rol</label>
        <input id="user-role" type="text" class="form-control" [(ngModel)]="user.role" name="role" [disabled]="!isEditing" />
      </div>

      <div class="form-field">
        <label for="user-institution">Institución</label>
        <input id="user-institution" type="text" class="form-control" [(ngModel)]="user.institution_name" name="institution" [disabled]="true" />
      </div>

      <div class="form-field">
        <label for="user-created_at">Registrado</label>
        <input id="user-created_at" type="text" class="form-control" [value]="user.created_at | date: 'short'" disabled />
      </div>
    </div>

    <div class="form-field form-field--full">
      <label for="user-bio">Biografía</label>
      <textarea id="user-bio" class="form-control" [(ngModel)]="user.bio" name="bio" [disabled]="!isEditing"></textarea>
    </div>

    <!-- BOTONES (locales del formulario ya que los principales están en el header) -->
    <div class="form-actions" style="display:none;">
      <!-- leave hidden; actions are in header -->
    </div>
  </form>
</div>

<!-- FOOTER -->
<app-footer></app-footer>
